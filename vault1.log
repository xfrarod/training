Script started on Wed 03 May 2017 05:39:09 PM UTC
training@hashicorp > 
training@hashicorp > 
training@hashicorp > vault list policies
No value found at policies/
training@hashicorp > vi v[Kbase [K.hcl
[?1049h[?1h=[2;1Hâ–½[6n[1;1H  [1;1H[1;38r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[38;1H"base.hcl" [New File][>c[2;1H[94m~                                                                                                                                                                                    [3;1H~                                                                                                                                                                                    [4;1H~                                                                                                                                                                                    [5;1H~                                                                                                                                                                                    [6;1H~                                                                                                                                                                                    [7;1H~                                                                                                                                                                                    [8;1H~                                                                                                                                                                                    [9;1H~                                                                                                                                                                                    [10;1H~                                                                                                                                                                                    [11;1H~                                                                                                                                                                                    [12;1H~                                                                                                                                                                                    [13;1H~                                                                                                                                                                                    [14;1H~                                                                                                                                                                                    [15;1H~                                                                                                                                                                                    [16;1H~                                                                                                                                                                                    [17;1H~                                                                                                                                                                                    [18;1H~                                                                                                                                                                                    [19;1H~                                                                                                                                                                                    [20;1H~                                                                                                                                                                                    [21;1H~                                                                                                                                                                                    [22;1H~                                                                                                                                                                                    [23;1H~                                                                                                                                                                                    [24;1H~                                                                                                                                                                                    [25;1H~                                                                                                                                                                                    [26;1H~                                                                                                                                                                                    [27;1H~                                                                                                                                                                                    [28;1H~                                                                                                                                                                                    [29;1H~                                                                                                                                                                                    [30;1H~                                                                                                                                                                                    [31;1H~                                                                                                                                                                                    [32;1H~                                                                                                                                                                                    [33;1H~                                                                                                                                                                                    [34;1H~                                                                                                                                                                                    [35;1H~                                                                                                                                                                                    [36;1H~                                                                                                                                                                                    [37;1H~                                                                                                                                                                                    [m[38;164H0,0-1[9CAll[1;1H[?12l[?25h[?25lx[38;164H1,1  [1;1H[?12l[?25h[?25l[38;1H[1m-- INSERT --[m[38;13H[K[38;164H1,2[11CAll[1;2H[?12l[?25h[?25lt[38;166H3[1;3H[?12l[?25h[?25lh[38;166H4[1;4H[?12l[?25h[?25l[38;166H5[1;5H[?12l[?25h[?25l"[38;166H6[1;6H[?12l[?25h[?25ls[38;166H7[1;7H[?12l[?25h[?25le[38;166H8[1;8H[?12l[?25h[?25lc[38;166H9[1;9H[?12l[?25h[?25lr[38;166H10[1;10H[?12l[?25h[?25le[38;167H1[1;11H[?12l[?25h[?25lt[38;167H2[1;12H[?12l[?25h[?25l/[38;167H3[1;13H[?12l[?25h[?25lt[38;167H4[1;14H[?12l[?25h[?25lr[38;167H5[1;15H[?12l[?25h[?25la[38;167H6[1;16H[?12l[?25h[?25li[38;167H7[1;17H[?12l[?25h[?25ln[38;167H8[1;18H[?12l[?25h[?25li[38;167H9[1;19H[?12l[?25h[?25ln[38;166H20[1;20H[?12l[?25h[?25lg[38;167H1[1;21H[?12l[?25h[?25l"[38;167H2[1;22H[?12l[?25h[?25l[38;167H1[1;21H[?12l[?25h[?25l_"[38;167H2[1;22H[?12l[?25h[?25l*"[38;167H3[1;23H[?12l[?25h[?25l[38;167H4[1;24H[?12l[?25h[?25l[38;167H5[1;25H[?12l[?25h[?25l{[38;164H[K[38;164H1,26[10CAll[1;26H[?12l[?25h[?25l[106m{}[m[38;164H[K[38;164H1,27[10CAll[1;27H[?12l[?25h[?25l[38;167H6[1;26H[?12l[?25h[?25l[1;26H[K[2;1H[106m}[m[2;2H[K[38;164H2,1 [2;1H[?12l[?25h[?25l[1;25H{
}[38;164H1[1;1H[?12l[?25h[?25lxxth "secret/training_*" {[38;166H2[1;2H[?12l[?25h[38;1H[K[1;1H[?25l[38;164H1,1[11CAll[1;1H[?12l[?25h[?25l[38;1H[1m-- INSERT --[m[38;164H[K[38;164H1,1[11CAll[1;1H "secret/training_*" {[1;23H[K[1;1H[?12l[?25h[?25lp "secret/training_*" {[38;166H2[1;2H[?12l[?25h[?25la "secret/training_*" {[38;166H3[1;3H[?12l[?25h[?25lt "secret/training_*" {[38;166H4[1;4H[?12l[?25h[?25lh "secret/training_*" {[38;166H5[1;5H[?12l[?25h[?25l[21C[106m{
}[m[38;164H[K[38;164H2,2[11CAll[2;2H[?12l[?25h[?25l[38;166H1[2;1H[?12l[?25h[?25l[38;164H[K[38;164H2,2[11CAll[2;2H[?12l[?25h[?25l[1;26H{
}[3;1H[K[38;164H3,1[3;1H[?12l[?25h[?25l[1;26H[106m{
}[m[38;164H2[2;1H[?12l[?25h[?25l[3;37r[3;1H[L[1;38r[2;1H[K[3;1H[106m}[m[38;164H[K[38;164H3,1[11CAll[3;1H[?12l[?25h[?25l[1;26H{

}[38;164H2[2;1H[?12l[?25h[?25l[38;166H2[2;2H[?12l[?25h[?25l[38;166H3[2;3H[?12l[?25h[?25lc[38;166H4[2;4H[?12l[?25h[?25la[38;166H5[2;5H[?12l[?25h[?25lp[38;166H6[2;6H[?12l[?25h[?25la[38;166H7[2;7H[?12l[?25h[?25lb[38;166H8[2;8H[?12l[?25h[?25li[38;166H9[2;9H[?12l[?25h[?25ll[38;166H10[2;10H[?12l[?25h[?25li[38;167H1[2;11H[?12l[?25h[?25lt[38;167H2[2;12H[?12l[?25h[?25li[38;167H3[2;13H[?12l[?25h[?25le[38;167H4[2;14H[?12l[?25h[?25ls[38;167H5[2;15H[?12l[?25h[?25l[38;167H6[2;16H[?12l[?25h[?25l=[38;167H7[2;17H[?12l[?25h[?25l[38;167H8[2;18H[?12l[?25h[?25l[[38;164H[K[38;164H2,19[10CAll[2;19H[?12l[?25h[?25l[106m[][m[38;164H[K[38;164H2,20[10CAll[2;20H[?12l[?25h[?25l[38;166H19[2;19H[?12l[?25h[?25l"[106m][m[38;166H20[2;20H[?12l[?25h[?25l"[106m][m[38;167H1[2;21H[?12l[?25h[?25l,[106m][m[38;167H2[2;22H[?12l[?25h[?25l [106m][m[38;167H3[2;23H[?12l[?25h[?25l"[106m][m[38;167H4[2;24H[?12l[?25h[?25l"[106m][m[38;167H5[2;25H[?12l[?25h[?25l[2;18H["", ""][38;167H4[2;24H[?12l[?25h[?25lr"][38;167H5[2;25H[?12l[?25h[?25le"][38;167H6[2;26H[?12l[?25h[?25la"][38;167H7[2;27H[?12l[?25h[?25ld"][38;167H8[2;28H[?12l[?25h[?25l[38;167H7[2;27H[?12l[?25h[?25l[38;167H6[2;26H[?12l[?25h[?25l[38;167H5[2;25H[?12l[?25h[?25l[38;167H4[2;24H[?12l[?25h[?25l[38;167H3[2;23H[?12l[?25h[?25l[38;167H2[2;22H[?12l[?25h[?25l[38;167H1[2;21H[?12l[?25h[?25l[38;167H0[2;20H[?12l[?25h[?25lc", "read"][38;167H1[2;21H[?12l[?25h[?25lr", "read"][38;167H2[2;22H[?12l[?25h[?25le", "read"][38;167H3[2;23H[?12l[?25h[?25la", "read"][38;167H4[2;24H[?12l[?25h[?25lt", "read"][38;167H5[2;25H[?12l[?25h[?25le", "read"][38;167H6[2;26H[?12l[?25h[?25l[38;167H7[2;27H[?12l[?25h[?25l[38;167H8[2;28H[?12l[?25h[?25l[38;167H9[2;29H[?12l[?25h[?25l[38;166H30[2;30H[?12l[?25h[?25l[38;167H1[2;31H[?12l[?25h[?25l[38;167H2[2;32H[?12l[?25h[?25l[38;167H3[2;33H[?12l[?25h[?25l[38;167H4[2;34H[?12l[?25h[?25l[2;18H[106m[[16C][m[38;167H5[2;35H[?12l[?25h[?25l[38;164H[K[38;164H2,36[10CAll[2;36H[?12l[?25h[38;1H[K[2;35H[?25l[38;164H2,35[10CAll[2;35H[?12l[?25h[?25l[38;164H[K[38;1H:[?12l[?25hw[?25l[?12l[?25hq[?25l[?12l[?25h[?25l"base.hcl" [New] 4L, 66C written
[?1l>[?12l[?25h[?1049ltraining@hashicorp > cat exercise.tpl 
{{ key "foo" }}
training@hashicorp > cat exercise.tpl [Kvi exercise.tpl [K[K[K[K[K[K[K[K[K[K[K.ne[K[K[K[K[K[K[K[Kvi ex.nomad
[?1049h[?1h=[2;1Hâ–½[6n[1;1H  [1;1H[1;38r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[38;1H"ex.nomad" [New File][>c[2;1H[94m~                                                                                                                                                                                    [3;1H~                                                                                                                                                                                    [4;1H~                                                                                                                                                                                    [5;1H~                                                                                                                                                                                    [6;1H~                                                                                                                                                                                    [7;1H~                                                                                                                                                                                    [8;1H~                                                                                                                                                                                    [9;1H~                                                                                                                                                                                    [10;1H~                                                                                                                                                                                    [11;1H~                                                                                                                                                                                    [12;1H~                                                                                                                                                                                    [13;1H~                                                                                                                                                                                    [14;1H~                                                                                                                                                                                    [15;1H~                                                                                                                                                                                    [16;1H~                                                                                                                                                                                    [17;1H~                                                                                                                                                                                    [18;1H~                                                                                                                                                                                    [19;1H~                                                                                                                                                                                    [20;1H~                                                                                                                                                                                    [21;1H~                                                                                                                                                                                    [22;1H~                                                                                                                                                                                    [23;1H~                                                                                                                                                                                    [24;1H~                                                                                                                                                                                    [25;1H~                                                                                                                                                                                    [26;1H~                                                                                                                                                                                    [27;1H~                                                                                                                                                                                    [28;1H~                                                                                                                                                                                    [29;1H~                                                                                                                                                                                    [30;1H~                                                                                                                                                                                    [31;1H~                                                                                                                                                                                    [32;1H~                                                                                                                                                                                    [33;1H~                                                                                                                                                                                    [34;1H~                                                                                                                                                                                    [35;1H~                                                                                                                                                                                    [36;1H~                                                                                                                                                                                    [37;1H~                                                                                                                                                                                    [m[38;164H0,0-1[9CAll[1;1H[?12l[?25h[?25l[38;1H[K[38;1H:[?12l[?25hq[?25l[?12l[?25h[?25l[38;1H[K[38;1H[?1l>[?12l[?25h[?1049ltraining@hashicorp > vi base.hcl 
base.hcl       .bash_logout   .cache/        .gitconfig     .profile       .ssh/          vault.log      .viminfo       
.bash_history  .bashrc        exercise.tpl   out.txt        .psqlrc        vault1.log     .vault-token   
training@hashicorp > vi base.hcl 
[?1049h[?1h=[2;1Hâ–½[6n[1;1H  [1;1H[1;38r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[38;1H"base.hcl" 4L, 66C[>c[1;1Hpath "secret/training_*" {
  capabilities = ["create", "read"]
}

[94m~                                                                                                                                                                                    [6;1H~                                                                                                                                                                                    [7;1H~                                                                                                                                                                                    [8;1H~                                                                                                                                                                                    [9;1H~                                                                                                                                                                                    [10;1H~                                                                                                                                                                                    [11;1H~                                                                                                                                                                                    [12;1H~                                                                                                                                                                                    [13;1H~                                                                                                                                                                                    [14;1H~                                                                                                                                                                                    [15;1H~                                                                                                                                                                                    [16;1H~                                                                                                                                                                                    [17;1H~                                                                                                                                                                                    [18;1H~                                                                                                                                                                                    [19;1H~                                                                                                                                                                                    [20;1H~                                                                                                                                                                                    [21;1H~                                                                                                                                                                                    [22;1H~                                                                                                                                                                                    [23;1H~                                                                                                                                                                                    [24;1H~                                                                                                                                                                                    [25;1H~                                                                                                                                                                                    [26;1H~                                                                                                                                                                                    [27;1H~                                                                                                                                                                                    [28;1H~                                                                                                                                                                                    [29;1H~                                                                                                                                                                                    [30;1H~                                                                                                                                                                                    [31;1H~                                                                                                                                                                                    [32;1H~                                                                                                                                                                                    [33;1H~                                                                                                                                                                                    [34;1H~                                                                                                                                                                                    [35;1H~                                                                                                                                                                                    [36;1H~                                                                                                                                                                                    [37;1H~                                                                                                                                                                                    [m[38;164H1,1[11CAll[1;1H[?12l[?25h[?25l[38;1H[K[38;1H:[?12l[?25hq[?25l[?12l[?25h[?25l[38;1H[K[38;1H[?1l>[?12l[?25h[?1049ltraining@hashicorp > vault policy-write base ./base.hcl 
Policy 'base' written.
training@hashicorp > vault wei[K[Krite sys/policy/po[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[Kvault plicies
usage: vault [-version] [-help] <command> [args]

Common commands:
    delete           Delete operation on secrets in Vault
    path-help        Look up the help for a path
    read             Read data or secrets from Vault
    renew            Renew the lease of a secret
    revoke           Revoke a secret.
    server           Start a Vault server
    status           Outputs status of whether Vault is sealed and if HA mode is enabled
    unwrap           Unwrap a wrapped secret
    write            Write secrets or configuration into Vault

All other commands:
    audit-disable    Disable an audit backend
    audit-enable     Enable an audit backend
    audit-list       Lists enabled audit backends in Vault
    auth             Prints information about how to authenticate with Vault
    auth-disable     Disable an auth provider
    auth-enable      Enable a new auth provider
    capabilities     Fetch the capabilities of a token on a given path
    generate-root    Generates a new root token
    init             Initialize a new Vault server
    key-status       Provides information about the active encryption key
    list             List data or secrets in Vault
    mount            Mount a logical backend
    mount-tune       Tune mount configuration parameters
    mounts           Lists mounted backends in Vault
    policies         List the policies on the server
    policy-delete    Delete a policy from the server
    policy-write     Write a policy to the server
    rekey            Rekeys Vault to generate new unseal keys
    remount          Remount a secret backend to a new path
    rotate           Rotates the backend encryption key used to persist data
    seal             Seals the vault server
    ssh              Initiate a SSH session
    step-down        Force the Vault node to give up active duty
    token-create     Create a new auth token
    token-lookup     Display information about the specified token
    token-renew      Renew an auth token if there is an associated lease
    token-revoke     Revoke one or more auth tokens
    unmount          Unmount a secret backend
    unseal           Unseals the vault server
    version          Prints the Vault version

training@hashicorp > vault pliciesolicies
base
default
root
training@hashicorp > vault read sys7[K/policy/base
Key  	Value
---  	-----
name 	base
rules	path "secret/training_*" {
  capabilities = ["create", "read"]
}

training@hashicorp > vault read sys/policy/base[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[Kpolicies base
path "secret/training_*" {
  capabilities = ["create", "read"]
}


training@hashicorp > vault token-create -policy=base
Key            	Value
---            	-----
token          	e92c3d23-3223-4736-e409-3e8e7a5f3ff4
token_accessor 	285d4616-ef45-df6c-e9f3-0afb37c50826
token_duration 	768h0m0s
token_renewable	true
token_policies 	[base default]

training@hashicorp > vault token-create -policy=base
Key            	Value
---            	-----
token          	74d9289a-1bbc-fa06-12d3-00db8bdd8a40
token_accessor 	af46a6c3-3f2f-277b-6f55-1b9e487e850e
token_duration 	768h0m0s
token_renewable	true
token_policies 	[base default]

training@hashicorp > vault auth 74d9289a-1bbc-fa06-12d3-00db8bdd8a40
Successfully authenticated! You are now logged in.
token: 74d9289a-1bbc-fa06-12d3-00db8bdd8a40
token_duration: 2764765
token_policies: [base default]
training@hashicorp > vault policies
Error: Error making API request.

URL: GET http://127.0.0.1:8200/v1/sys/policy
Code: 403. Errors:

* permission denied
training@hashicorp > vault write secret/fi[Koo bar=1
Error writing data to secret/foo: Error making API request.

URL: PUT http://127.0.0.1:8200/v1/secret/foo
Code: 403. Errors:

* permission denied
training@hashicorp > vault write secret/foo bar=1[C[C[1@t[1@r[1@a[1@i[1@n[1@i[1@n[1@g[1@_
Success! Data written to: secret/training_foo
training@hashicorp > vault write secret/training_foo bar=1[K2
Error writing data to secret/training_foo: Error making API request.

URL: PUT http://127.0.0.1:8200/v1/secret/training_foo
Code: 403. Errors:

* permission denied
training@hashicorp > ll
total 120
drwxr-xr-x 4 training training  4096 May  3 17:42 [0m[01;34m.[0m/
drwxr-xr-x 4 root     root      4096 May  2 03:04 [01;34m..[0m/
-rw-rw-r-- 1 training training    66 May  3 17:40 base.hcl
-rw------- 1 training training  7694 May  3 17:35 .bash_history
-rw-r--r-- 1 training training   220 Apr  9  2014 .bash_logout
-rw-r--r-- 1 training training  3666 May  2 03:04 .bashrc
drwxrwxr-x 2 training training  4096 May  2 03:04 [01;34m.cache[0m/
-rw-rw-r-- 1 training training    16 May  2 22:53 exercise.tpl
-rw-rw-r-- 1 training training   129 May  2 03:04 .gitconfig
-rw-r--r-- 1 training training     4 May  2 22:53 out.txt
-rw-r--r-- 1 training training   675 Apr  9  2014 .profile
-rw-r--r-- 1 training training   146 May  2 03:05 .psqlrc
drwx------ 2 training training  4096 May  2 03:04 [01;34m.ssh[0m/
-rw-rw-r-- 1 training training 28672 May  3 17:43 vault1.log
-rw-rw-r-- 1 training training 20480 May  3 17:06 vault.log
-rw------- 1 training training    36 May  3 17:47 .vault-token
-rw------- 1 training training  6116 May  3 17:42 .viminfo
training@hashicorp > cp base.hcl exercise.hcl
training@hashicorp > vi exercise.hcl 
[?1049h[?1h=[2;1Hâ–½[6n[1;1H  [1;1H[1;38r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[38;1H"exercise.hcl" 4L, 66C[>c[1;1Hpath "secret/training_*" {
  capabilities = ["create", "read"]
}

[94m~                                                                                                                                                                                    [6;1H~                                                                                                                                                                                    [7;1H~                                                                                                                                                                                    [8;1H~                                                                                                                                                                                    [9;1H~                                                                                                                                                                                    [10;1H~                                                                                                                                                                                    [11;1H~                                                                                                                                                                                    [12;1H~                                                                                                                                                                                    [13;1H~                                                                                                                                                                                    [14;1H~                                                                                                                                                                                    [15;1H~                                                                                                                                                                                    [16;1H~                                                                                                                                                                                    [17;1H~                                                                                                                                                                                    [18;1H~                                                                                                                                                                                    [19;1H~                                                                                                                                                                                    [20;1H~                                                                                                                                                                                    [21;1H~                                                                                                                                                                                    [22;1H~                                                                                                                                                                                    [23;1H~                                                                                                                                                                                    [24;1H~                                                                                                                                                                                    [25;1H~                                                                                                                                                                                    [26;1H~                                                                                                                                                                                    [27;1H~                                                                                                                                                                                    [28;1H~                                                                                                                                                                                    [29;1H~                                                                                                                                                                                    [30;1H~                                                                                                                                                                                    [31;1H~                                                                                                                                                                                    [32;1H~                                                                                                                                                                                    [33;1H~                                                                                                                                                                                    [34;1H~                                                                                                                                                                                    [35;1H~                                                                                                                                                                                    [36;1H~                                                                                                                                                                                    [37;1H~                                                                                                                                                                                    [m[38;164H1,1[11CAll[1;1H[?12l[?25h[?25l[38;166H2[1;2H[?12l[?25h[?25l[38;166H3[1;3H[?12l[?25h[?25l[38;166H4[1;4H[?12l[?25h[?25l[38;166H5[1;5H[?12l[?25h[?25l[38;166H6[1;6H[?12l[?25h[?25l[38;166H7[1;7H[?12l[?25h[?25l[38;166H8[1;8H[?12l[?25h[?25l[38;166H9[1;9H[?12l[?25h[?25l[38;166H10[1;10H[?12l[?25h[?25l[38;167H1[1;11H[?12l[?25h[?25l[38;167H2[1;12H[?12l[?25h[?25l[38;167H3[1;13H[?12l[?25h[?25l[38;167H4[1;14H[?12l[?25h[?25lraining_*" {[1;26H[K[1;14H[?12l[?25h[?25laining_*" {[1;25H[K[1;14H[?12l[?25h[?25lining_*" {[1;24H[K[1;14H[?12l[?25h[?25lning_*" {[1;23H[K[1;14H[?12l[?25h[?25ling_*" {[1;22H[K[1;14H[?12l[?25h[?25lng_*" {[1;21H[K[1;14H[?12l[?25h[?25lg_*" {[1;20H[K[1;14H[?12l[?25h[?25l_*" {[1;19H[K[1;14H[?12l[?25h[?25l*" {[1;18H[K[1;14H[?12l[?25h[?25l[38;164H2[2;14H[?12l[?25h[?25l[38;167H5[2;15H[?12l[?25h[?25l[38;167H6[2;16H[?12l[?25h[?25l[38;167H7[2;17H[?12l[?25h[?25l [106m[[16C][m[38;167H8[2;18H[?12l[?25h[?25l[1;17H[106m{[m[2;18H[[16C]
[106m}[m[38;164H3,1 [3;1H[?12l[?25h[?25l[1;17H{

}[38;164H4,0-1[4;1H[?12l[?25h[?25l[38;1H[1m-- INSERT --[m[38;13H[K[38;164H4,1[11CAll[4;1H[?12l[?25h[?25l[5;1H[K[38;164H5[5;1H[?12l[?25h[?25lpath "secret/*" [106m{[m
  capabilities = ["create", "read"][6;36H[K[7;1H[106m}[m[7;2H[K[38;164H[K[38;164H7,2[11CAll[7;2H[?12l[?25h[?25l[38;166H1[7;1H[?12l[?25h[?25l[5;17H{

}[38;164H6[6;1H[?12l[?25h[?25l[38;166H2[6;2H[?12l[?25h[?25l[38;164H5[5;2H[?12l[?25h[?25l[38;166H3[5;3H[?12l[?25h[?25l[38;166H4[5;4H[?12l[?25h[?25l[38;166H5[5;5H[?12l[?25h[?25l[38;166H6[5;6H[?12l[?25h[?25l[38;166H7[5;7H[?12l[?25h[?25l[38;166H8[5;8H[?12l[?25h[?25l[38;166H9[5;9H[?12l[?25h[?25l[38;166H10[5;10H[?12l[?25h[?25l[38;167H1[5;11H[?12l[?25h[?25l[38;167H2[5;12H[?12l[?25h[?25l[38;167H3[5;13H[?12l[?25h[?25l[38;167H4[5;14H[?12l[?25h[38;1H[K[5;13H[?25l[38;164H5,13[10CAll[5;13H[?12l[?25h[?25l[38;164H4,0-1[4;1H[?12l[?25h[?25l[1;17H[106m{

}[m[38;164H3,1  [3;1H[?12l[?25h[?25l[1;17H{

}[38;164H4,0-1[4;1H[?12l[?25h[?25l[1;17H[106m{

}[m[38;164H3,1  [3;1H[?12l[?25h[?25l[1;17H{

}[38;164H4,0-1[4;1H[?12l[?25h[?25l[1;17H[106m{

}[m[38;164H3,1  [3;1H[?12l[?25h[?25l[1;17H{

}[38;164H4,0-1[4;1H[?12l[?25h[?25l[1;17H[106m{

}[m[38;164H3,1  [3;1H[?12l[?25h[?25l[1;17H{

}[38;164H2,13[2;13H[?12l[?25h[?25l[38;167H4[2;14H[?12l[?25h[?25l[38;167H5[2;15H[?12l[?25h[?25l[38;167H6[2;16H[?12l[?25h[?25l[38;167H7[2;17H[?12l[?25h[?25l [106m[[16C][m[38;167H8[2;18H[?12l[?25h[?25l[[16C][38;167H9[2;19H[?12l[?25h[?25l[38;166H20[2;20H[?12l[?25h[?25l[38;1H[1m-- INSERT --[m[38;164H[K[38;164H2,20[10CAll[2;20H", "read"][2;30H[K[2;20H[?12l[?25h[?25ll", "read"][38;167H1[2;21H[?12l[?25h[?25li", "read"][38;167H2[2;22H[?12l[?25h[?25ls", "read"][38;167H3[2;23H[?12l[?25h[?25lt", "read"][38;167H4[2;24H[?12l[?25h[?25l[38;167H5[2;25H[?12l[?25h[?25l[38;167H6[2;26H[?12l[?25h[?25l[38;167H7[2;27H[?12l[?25h[?25l[38;167H8[2;28H[?12l[?25h[?25ldread"][38;167H9[2;29H[?12l[?25h[?25leread"][38;166H30[2;30H[?12l[?25h[?25llread"][38;167H1[2;31H[?12l[?25h[?25leread"][38;167H2[2;32H[?12l[?25h[?25ltread"][38;167H3[2;33H[?12l[?25h[?25leread"][38;167H4[2;34H[?12l[?25h[38;1H[K[2;33H[?25l[38;164H2,33[10CAll[2;33H[?12l[?25h[?25l[38;167H2[2;32H[?12l[?25h[?25l[38;167H1[2;31H[?12l[?25h[?25l[38;167H0[2;30H[?12l[?25h[?25l[38;166H29[2;29H[?12l[?25h[?25l[38;167H8[2;28H[?12l[?25h[?25l[38;166H3[2;38H[?12l[?25h[?25l[38;167H7[2;37H[?12l[?25h[?25l[38;167H6[2;36H[?12l[?25h[?25l[38;167H5[2;35H[?12l[?25h[?25l[38;167H4[2;34H[?12l[?25h[?25l[38;167H3[2;33H[?12l[?25h[?25l[38;167H2[2;32H[?12l[?25h[?25l[38;167H1[2;31H[?12l[?25h[?25l[38;167H0[2;30H[?12l[?25h[?25l[38;166H29[2;29H[?12l[?25h[?25l[38;167H8[2;28H[?12l[?25h[?25l[38;1H[1m-- INSERT --[m[38;164H[K[38;164H2,28[10CAll[2;28H"][2;30H[K[2;28H[?12l[?25h[?25ld"][38;167H9[2;29H[?12l[?25h[?25le"][38;166H30[2;30H[?12l[?25h[?25ll"][38;167H1[2;31H[?12l[?25h[?25le"][38;167H2[2;32H[?12l[?25h[?25lt"][38;167H3[2;33H[?12l[?25h[?25le"][38;167H4[2;34H[?12l[?25h[?25l[1;17H[106m{

}[m[38;164H[K[38;164H3,2[11CAll[3;2H[?12l[?25h[?25l[1;17H{

}[38;164H4,1[4;1H[?12l[?25h[?25l[5;17H[106m{

}[m[38;164H[K[38;164H5,18[10CAll[5;18H[?12l[?25h[?25l{

}[38;164H6,34[6;34H[?12l[?25h[?25l[5;17H[106m{

}[m[38;164H[K[38;164H5,18[10CAll[5;18H[?12l[?25h[?25l{

}[38;164H4,1 [4;1H[?12l[?25h[38;1H[K[4;1H[?25l[38;164H4,0-1[9CAll[4;1H[?12l[?25h[?25l[38;164H5,1  [5;1H[?12l[?25h[?25l[5;37r[37;1H
[1;38r[37;1H[94m~                                                                                                                                                                                    [m[38;164H[K[38;164H5,3[11CAll[5;3H[?12l[?25h[?25l[5;37r[37;1H
[1;38r[37;1H[94m~                                                                                                                                                                                    [m[38;164H[K[38;164H5,1[11CAll[5;1H[?12l[?25h[?25l[94m~                                                                                                                                                                                    [m[38;164H4,0-1[4;1H[?12l[?25h[?25l[38;164H[K[38;1H:[?12l[?25hw[?25l[?12l[?25hq[?25l[?12l[?25h[?25l"exercise.hcl" 4L, 57C written
[?1l>[?12l[?25h[?1049ltraining@hashicorp > 
training@hashicorp > 
training@hashicorp > vault auth root
Successfully authenticated! You are now logged in.
token: root
token_duration: 0
token_policies: [root]
training@hashicorp > 
training@hashicorp > 
training@hashicorp > 
training@hashicorp > echo "vault auth rooti exercise.hcl cp base.hcl exercise.hcl[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cll[Kvault write secret/training_foo bar=21[9P[C[C[C[C[C[C[C[C[C[14Ppoliciesauth 74d9289a-1bbc-fa06-12d3-00db8bdd8a40[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[16Ptoken-create -policy=base[12Ppolicies baseread sys/policy/base[12Ppolicies[1Pliciesolicy-write base ./base.hcl [C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Ci base.hcl [K[1Pex.nomadcat exercise.tpl [6Pvi base.hclault list policiesecho "****************** VAULT SEAL ***********************"[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[34Pvault path-help cubbyhole/[3Psecret/cubbyhole/[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cecho "****************** VAULT SEAL ***********************"[C[1P ***********************"[1P ***********************"[1P ***********************"[1P ***********************"[1P***********************"[1P ***********************"[1P ***********************"[1P ***********************"[1P ***********************"[1P ***********************"D ***********************"I ***********************"N ***********************"A ***********************"M ***********************"I ***********************"C ***********************"[C ***********************"S ***********************"E ***********************"C ***********************"R ***********************"E ***********************"T ***********************"S ***********************"
****************** DINAMIC SECRETS ***********************
training@hashicorp > 
training@hashicorp > 
training@hashicorp > 
training@hashicorp > vault mount postgress[Kql
Successfully mounted 'postgresql' at 'postgresql'!
training@hashicorp > vault pah[Kth-help postgresql/
## DESCRIPTION

The PostgreSQL backend dynamically generates database users.

After mounting this backend, configure it using the endpoints within
the "config/" path.

## PATHS

The following paths are supported by this backend. To view help for
any of the paths below, use the help command with any route matching
the path pattern. Note that depending on the policy of your auth token,
you may or may not be able to access certain paths.

    ^config/connection$
        Configure the connection string to talk to PostgreSQL.

    ^config/lease$
        Configure the default lease information for generated credentials.

    ^creds/(?P<name>\w(([\w-.]+)?\w)?)$
        Request database credentials for a certain role.

    ^roles/(?P<name>\w(([\w-.]+)?\w)?)$
        Manage the roles that can be created with this backend.

    ^roles/?$
        Manage the roles that can be created with this backend.
training@hashicorp > 
training@hashicorp > 
training@hashicorp > 
training@hashicorp > vault path-help postgress/config/connection
Error reading help: Error making API request.

URL: GET http://127.0.0.1:8200/v1/postgress/config/connection?help=1
Code: 404. Errors:

* no handler for route 'postgress/config/connection/'
training@hashicorp > vault path-help postgress/config/connection[1P/config/connectionq/config/connectionl/config/connection
Request:        config/connection
Matching Route: ^config/connection$

Configure the connection string to talk to PostgreSQL.

## PARAMETERS

    connection_url (string)
        DB connection string

    max_idle_connections (int)
        Maximum number of idle connections to the database;
        a zero uses the value of max_open_connections
        and a negative value disables idle connections.
        If larger than max_open_connections it will be
        reduced to the same size.

    max_open_connections (int)
        Maximum number of open connections to the database;
        a zero uses the default value of two and a
        negative value means unlimited

    value (string)
        DB connection string. Use 'connection_url' instead.
        This will be deprecated.

    verify_connection (bool)
        If set, connection_url is verified by actually connecting to the database

## DESCRIPTION

This path configures the connection string used to connect to PostgreSQL.
The value of the string can be a URL, or a PG style string in the
format of "user=foo host=bar" etc.

The URL looks like:
"postgresql://user:pass@host:port/dbname"

When configuring the connection string, the backend will verify its validity.
training@hashicorp > vault path-help postgresql/config/connection[1P postgresql/config/connection[1P postgresql/config/connection[1P postgresql/config/connection[1P postgresql/config/connection[1P postgresql/config/connection[1P postgresql/config/connection[1P postgresql/config/connection[1P postgresql/config/connection[1P postgresql/config/connection[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cw postgresql/config/connectionr postgresql/config/connectioni postgresql/config/connectiont postgresql/config/connectione postgresql/config/connection[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C c[K\
> connection=[K_url=""p"o"s"t"g"r"e"s"s"[1P"q"q"l"[1P"[1P"l"="[1P":"/"/"p"o"s"t"g"r"e"s"s"@"l"o"c"a"l"h"o"s"t"/"m"y"a"p"p"
Error writing data to postgresql/config/connection: Error making API request.

URL: PUT http://127.0.0.1:8200/v1/postgresql/config/connection
Code: 400. Errors:

* Error validating connection info: pq: role "postgress" does not exist
training@hashicorp > vault write postgresql/config/connection connection_url="postgresql://postgress@localhost/myapp"[C[C[C[C[C[C[C[C[C[C[1P@localhost/myapp"


The following warnings were returned from the Vault server:
* Read access to this endpoint should be controlled via ACLs as it will return the connection string or URL as it is, including passwords, if any.
training@hashicorp > 
training@hashicorp > 
training@hashicorp > vault write postgresql/config/connection connection_url="postgresql://postgres@localhost/myapp"[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[1P postgresql/config/connection[1P postgresql/config/connection[1P postgresql/config/connection[1P postgresql/config/connection[1P postgresql/config/connection[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cr postgresql/config/connectione postgresql/config/connectiona postgresql/config/connectiond postgresql/config/connection
Key                 	Value
---                 	-----
connection_url      	postgresql://postgres@localhost/myapp
max_idle_connections	2
max_open_connections	2
value               	

training@hashicorp > vault read postgresql/config/connection[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cwrite postgresql/config/connection connection_url="postgresql://postgres@localhost/myapp"[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[Klease \
> lease=1h \
> lease_max=24h
Success! Data written to: postgresql/config/lease
training@hashicorp > vault write postgresql/config/lease lease=1h lease_max=24h[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[19Pread postgresql/config/connection[K[K[K[K[K[K[K[K[K[Klease
Key      	Value
---      	-----
lease    	1h0m0s
lease_max	24h0m0s

training@hashicorp > cd /workstation/vault/
training@hashicorp > ll
total 28
drwxr-xr-x 2 training training 4096 May  3 17:00 [0m[01;34m.[0m/
drwxr-xr-x 5 root     root     4096 May  2 03:05 [01;34m..[0m/
-rw-r--r-- 1 training training  185 May  2 03:05 app.rb
-rw-r--r-- 1 training training  289 May  2 03:05 config.hcl
-rw-r--r-- 1 training training  146 May  2 03:05 config.yml.tpl
-rw-rw-r-- 1 training training   33 May  3 17:00 pwd.txt
-rw-r--r-- 1 training training  147 May  2 03:05 readonly.sql
training@hashicorp > vi readonly.sql 
[?1049h[?1h=[2;1Hâ–½[6n[1;1H  [1;1H[1;38r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[38;1H"readonly.sql" 2L, 147C[>c[1;1H[38;5;130mCREATE[m ROLE [31m"{{name}}"[m [35mWITH[m LOGIN PASSWORD [31m'{{password}}'[m VALID UNTIL [31m'{{expiration}}'[m;
[38;5;130mGRANT[m [38;5;130mSELECT[m [35mON[m [38;5;130mALL[m TABLES [38;5;130mIN[m SCHEMA [35mpublic[m [35mTO[m [31m"{{name}}"[m;
[94m~                                                                                                                                                                                    [4;1H~                                                                                                                                                                                    [5;1H~                                                                                                                                                                                    [6;1H~                                                                                                                                                                                    [7;1H~                                                                                                                                                                                    [8;1H~                                                                                                                                                                                    [9;1H~                                                                                                                                                                                    [10;1H~                                                                                                                                                                                    [11;1H~                                                                                                                                                                                    [12;1H~                                                                                                                                                                                    [13;1H~                                                                                                                                                                                    [14;1H~                                                                                                                                                                                    [15;1H~                                                                                                                                                                                    [16;1H~                                                                                                                                                                                    [17;1H~                                                                                                                                                                                    [18;1H~                                                                                                                                                                                    [19;1H~                                                                                                                                                                                    [20;1H~                                                                                                                                                                                    [21;1H~                                                                                                                                                                                    [22;1H~                                                                                                                                                                                    [23;1H~                                                                                                                                                                                    [24;1H~                                                                                                                                                                                    [25;1H~                                                                                                                                                                                    [26;1H~                                                                                                                                                                                    [27;1H~                                                                                                                                                                                    [28;1H~                                                                                                                                                                                    [29;1H~                                                                                                                                                                                    [30;1H~                                                                                                                                                                                    [31;1H~                                                                                                                                                                                    [32;1H~                                                                                                                                                                                    [33;1H~                                                                                                                                                                                    [34;1H~                                                                                                                                                                                    [35;1H~                                                                                                                                                                                    [36;1H~                                                                                                                                                                                    [37;1H~                                                                                                                                                                                    [m[38;164H1,1[11CAll[1;1H[?12l[?25h[?25l[38;1H[K[38;1H:[?12l[?25hq[?25l[?12l[?25h[?25l[38;1H[K[38;1H[?1l>[?12l[?25h[?1049ltraining@hashicorp > vault write [4@i readonly.sql[Cll[Kcd /workstation/vault/vault read postgresql/config/lease[K[K[K[K[Kreadonly \[Ksql=@rea[K[K[Kreadonly.sql
read expects one argument
Usage: vault read [options] path

  Read data from Vault.

  Reads data at the given path from Vault. This can be used to read
  secrets and configuration as well as generate dynamic values from
  materialized backends. Please reference the documentation for the
  backends in use to determine key structure.

General Options:

  -address=addr           The address of the Vault server.
                          Overrides the VAULT_ADDR environment variable if set.

  -ca-cert=path           Path to a PEM encoded CA cert file to use to
                          verify the Vault server SSL certificate.
                          Overrides the VAULT_CACERT environment variable if set.

  -ca-path=path           Path to a directory of PEM encoded CA cert files
                          to verify the Vault server SSL certificate. If both
                          -ca-cert and -ca-path are specified, -ca-cert is used.
                          Overrides the VAULT_CAPATH environment variable if set.

  -client-cert=path       Path to a PEM encoded client certificate for TLS
                          authentication to the Vault server. Must also specify
                          -client-key. Overrides the VAULT_CLIENT_CERT
                          environment variable if set.

  -client-key=path        Path to an unencrypted PEM encoded private key
                          matching the client certificate from -client-cert.
                          Overrides the VAULT_CLIENT_KEY environment variable
                          if set.

  -tls-skip-verify        Do not verify TLS certificate. This is highly
                          not recommended. Verification will also be skipped
                          if VAULT_SKIP_VERIFY is set.

  -wrap-ttl=""            Indicates that the response should be wrapped in a
                          cubbyhole token with the requested TTL. The response
                          can be fetched by calling the "sys/wrapping/unwrap"
                          endpoint, passing in the wrappping token's ID. This
                          is a numeric string with an optional suffix
                          "s", "m", or "h"; if no suffix is specified it will
                          be parsed as seconds. May also be specified via
                          VAULT_WRAP_TTL.

Read Options:

  -format=table           The format for output. By default it is a whitespace-
                          delimited table. This can also be json or yaml.

  -field=field            If included, the raw value of the specified field
                          will be output raw to stdout.
training@hashicorp > vault read postgresql/config/readonly sql=@readonly.sql[1P[1P[1P[1P[1P[1@w[1@r[1@i[1@t[1@e[1@ 
Error writing data to postgresql/config/readonly: Error making API request.

URL: PUT http://127.0.0.1:8200/v1/postgresql/config/readonly
Code: 404. Errors:

* 1 error occurred:

* unsupported path
training@hashicorp > vault write postgresql/config/readonly sql=@readonly.sql[1P[1P[1P[1P[1P[1P[1@r[1@o[1@l[1@e[1@s
Success! Data written to: postgresql/roles/readonly
training@hashicorp > 
training@hashicorp > 
training@hashicorp > 
training@hashicorp > vu[K[Kvault write postgresql/roles/readonly sql=@readonly.sql[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[C[C[C[C[C[1P[1P[1P[1P[1P[1@c[1@r[1@e[1@d[1@s[1P[1P[1P[1P[1P[1@r[1@e[1@a[1@d
Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/f6f4d962-5935-6a3a-1ab4-f1c1a016eec2
lease_duration 	1h0m0s
lease_renewable	true
password       	5e72f3c0-48fe-e393-9f4e-1131d660ca2e
username       	token-b8e7c9f5-704a-53c6-db7f-6c9249553250

training@hashicorp > vault read postgresql/creds/readonly 
Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/93230816-f675-4050-9e90-e5347bb4cae2
lease_duration 	1h0m0s
lease_renewable	true
password       	7e3b1e12-b1de-21c6-2017-9201b1ecc784
username       	token-f5f6f43d-7ea7-31a4-21a5-859bd5265d45

training@hashicorp > postgress[K[K[K[K[K[K[K[Ksql -U postr[Kgres
Welcome to PostgreSQL for HashiCorp training!
Type \q to exit.

postgres > \du
                                              List of roles
                 Role name                  |                   Attributes                   | Member of 
--------------------------------------------+------------------------------------------------+-----------
 postgres                                   | Superuser, Create role, Create DB, Replication | {}
 token-b8e7c9f5-704a-53c6-db7f-6c9249553250 | Password valid until 2017-05-03 19:19:06+00    | {}
 token-f5f6f43d-7ea7-31a4-21a5-859bd5265d45 | Password valid until 2017-05-03 19:19:47+00    | {}

postgres > date
postgres-# ex[K[K
training@hashicorp > date
Wed May  3 18:22:24 UTC 2017
training@hashicorp > vault renew postgresql/creds/readonly/93230816-f675-4050-9e90-e5347bb4cae2
Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/93230816-f675-4050-9e90-e5347bb4cae2
lease_duration 	1h0m0s
lease_renewable	true

training@hashicorp > vault renew postgresql/creds/readonly/93230816-f675-4050-9e90-e5347bb4cae2[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cdate[Kpsql -U postgres
Welcome to PostgreSQL for HashiCorp training!
Type \q to exit.

postgres > \du
                                              List of roles
                 Role name                  |                   Attributes                   | Member of 
--------------------------------------------+------------------------------------------------+-----------
 postgres                                   | Superuser, Create role, Create DB, Replication | {}
 token-b8e7c9f5-704a-53c6-db7f-6c9249553250 | Password valid until 2017-05-03 19:19:06+00    | {}
 token-f5f6f43d-7ea7-31a4-21a5-859bd5265d45 | Password valid until 2017-05-03 19:24:55+00    | {}

postgres > 
training@hashicorp > psql -U postgresvault renew postgresql/creds/readonly/93230816-f675-4050-9e90-e5347bb4cae2[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[Kpostgresql/creds/readonly/f6f4d962-5935-6a3a-1ab4-f1c1a016eec2
Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/f6f4d962-5935-6a3a-1ab4-f1c1a016eec2
lease_duration 	1h0m0s
lease_renewable	true

training@hashicorp > vault renew postgresql/creds/readonly/f6f4d962-5935-6a3a-1ab4-f1c1a016eec2[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cpsql -U postgres[K
Welcome to PostgreSQL for HashiCorp training!
Type \q to exit.

postgres > \du
                                              List of roles
                 Role name                  |                   Attributes                   | Member of 
--------------------------------------------+------------------------------------------------+-----------
 postgres                                   | Superuser, Create role, Create DB, Replication | {}
 token-b8e7c9f5-704a-53c6-db7f-6c9249553250 | Password valid until 2017-05-03 19:26:07+00    | {}
 token-f5f6f43d-7ea7-31a4-21a5-859bd5265d45 | Password valid until 2017-05-03 19:24:55+00    | {}

postgres > 
training@hashicorp > psql -U postgresvault renew postgresql/creds/readonly/f6f4d962-5935-6a3a-1ab4-f1c1a016eec2[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[1P postgresql/creds/readonly/f6f4d962-5935-6a3a-1ab4-f1c1a016eec2[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[1P postgresql/creds/readonly/f6f4d962-5935-6a3a-1ab4-f1c1a016eec2[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[1P postgresql/creds/readonly/f6f4d962-5935-6a3a-1ab4-f1c1a016eec2[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[1P postgresql/creds/readonly/f6f4d962-5935-6a3a-1ab4-f1c1a016eec2[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cr postgresql/creds/readonly/f6f4d962-5935-6a3a-1ab4-f1c1a016eec2[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[1P postgresql/creds/readonly/f6f4d962-5935-6a3a-1ab4-f1c1a016eec2[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Ce postgresql/creds/readonly/f6f4d962-5935-6a3a-1ab4-f1c1a016eec2[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cv postgresql/creds/readonly/f6f4d962-5935-6a3a-1ab4-f1c1a016eec2[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Co postgresql/creds/readonly/f6f4d962-5935-6a3a-1ab4-f1c1a016eec2[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Ck postgresql/creds/readonly/f6f4d962-5935-6a3a-1ab4-f1c1a016eec2[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Ce postgresql/creds/readonly/f6f4d962-5935-6a3a-1ab4-f1c1a016eec2[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C
Success! Revoked the secret with ID 'postgresql/creds/readonly/f6f4d962-5935-6a3a-1ab4-f1c1a016eec2', if it existed.
training@hashicorp > vault revoke postgresql/creds/readonly/f6f4d962-5935-6a3a-1ab4-f1c1a016eec2[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cpsql -U postgres[K
Welcome to PostgreSQL for HashiCorp training!
Type \q to exit.

postgres > \du
                                              List of roles
                 Role name                  |                   Attributes                   | Member of 
--------------------------------------------+------------------------------------------------+-----------
 postgres                                   | Superuser, Create role, Create DB, Replication | {}
 token-f5f6f43d-7ea7-31a4-21a5-859bd5265d45 | Password valid until 2017-05-03 19:24:55+00    | {}

postgres > 
training@hashicorp > for in[K in {}1}.}.}2}0}[C; do vault read postgresql/creds/readonly; done
Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/faf5006f-bce3-df58-3e46-b5c1bd515d11
lease_duration 	1h0m0s
lease_renewable	true
password       	58f9bb31-f7fc-44f2-1f74-a4b286fb5028
username       	token-d0ca1790-6ca6-b45c-6d65-2b4822ee84c2

Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/7f20927e-270d-bd61-eaf4-e54ac2474c1d
lease_duration 	1h0m0s
lease_renewable	true
password       	be61ed22-bab4-0022-e6da-adf9fae15117
username       	token-c4ee81e6-2f9a-4816-d9ff-0ec1476be79f

Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/591d43aa-9466-e8d8-0308-5fd748e5058e
lease_duration 	1h0m0s
lease_renewable	true
password       	26582572-fd46-3e84-84f3-9cdd3efb2b72
username       	token-5f7e3c1a-6a49-9623-70e5-41251a50ce02

Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/d17aa898-8957-990e-3c6e-37c6f0d70c50
lease_duration 	1h0m0s
lease_renewable	true
password       	dd5cfef1-5ed8-cf32-b45d-a4ec1c0ba5ae
username       	token-72879332-fcda-cea0-ec34-5c988167dd94

Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/48d1eb02-567a-0eb3-d57e-3fb8a4820b00
lease_duration 	1h0m0s
lease_renewable	true
password       	3870baeb-edf1-188b-5465-804cb17a6776
username       	token-5916cb4e-2bd1-5e22-862f-343ed9d6b539

Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/7306f59f-e45f-9033-acab-38dc6acee016
lease_duration 	1h0m0s
lease_renewable	true
password       	40db9d7d-e3e3-766e-2d94-3d5780fdf5aa
username       	token-7bc7e9b3-09f5-5b15-8dd1-928aa12c914a

Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/442443d3-9b21-84eb-9294-4c4516cb4494
lease_duration 	1h0m0s
lease_renewable	true
password       	cf2337d2-9abe-f270-fa44-c6033bcf25ed
username       	token-e3f06c22-215f-a7ed-ed9d-272baaa776d4

Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/1fd0c5c9-ac0a-88b2-2ad7-974d7b682e3a
lease_duration 	1h0m0s
lease_renewable	true
password       	32cf3222-383c-05d1-ac85-395ece5f3380
username       	token-340348c1-0cae-c551-e4da-7a3b4fe2e8a9

Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/c3fee8cd-eee2-d268-107a-f77119a50f5e
lease_duration 	1h0m0s
lease_renewable	true
password       	0e56a42a-4f5e-7f01-77d6-755e95c949ce
username       	token-2af0e521-9e62-db8b-17b3-d3b6f4ce887f

Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/3e5b934a-04e7-e36b-3521-b942dc93f43e
lease_duration 	1h0m0s
lease_renewable	true
password       	41aac7bc-6cff-50dd-522a-8800f31dc1bd
username       	token-a1b138be-51e7-5852-31e3-f00929ac021e

Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/d809cd14-319d-f486-8413-2c8c31945f08
lease_duration 	1h0m0s
lease_renewable	true
password       	33d6ec98-5824-d707-6a55-1255fa832cfb
username       	token-99098f29-07d3-35a3-037c-540e3b5e978f

Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/965facb0-4381-5106-e711-f2c6059ca759
lease_duration 	1h0m0s
lease_renewable	true
password       	b8d5389a-4699-a103-b320-310d423235af
username       	token-1366559c-b02f-a015-b53b-7954382e1e24

Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/5afaee9b-e3fe-e517-64a3-6bc66ba5b88f
lease_duration 	1h0m0s
lease_renewable	true
password       	b9ece237-3a5e-7f36-7d9f-4af6f31d24c0
username       	token-3df6feb8-e3d2-608d-b9a8-e77454ca11d0

Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/29643a5c-2a6c-0795-a405-5435db846a5b
lease_duration 	1h0m0s
lease_renewable	true
password       	6d6fb033-e653-7c85-eddc-f2778a612751
username       	token-2948673e-1c8d-78ca-95f4-6819b4da0b9c

Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/7fdcc8e4-a5d5-e0b3-63fd-123877f9eb4f
lease_duration 	1h0m0s
lease_renewable	true
password       	f182ccdb-ff80-6b2e-2e97-fa60a24f5351
username       	token-ffc80404-02a0-55b8-5370-5d69cfc4f6fb

Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/f80f2c8a-ab5e-01f7-9391-fff40086a9f1
lease_duration 	1h0m0s
lease_renewable	true
password       	0cba068f-5ff9-a6a0-3164-2649a9b987db
username       	token-26e96be9-779a-c531-5ae6-025223238d79

Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/3093cb0c-7d15-2f84-de5a-9feeedddd7a4
lease_duration 	1h0m0s
lease_renewable	true
password       	6649b143-0de8-dd94-da4b-1b1f5f29e468
username       	token-de5e11af-5f19-6e36-9be8-d79f884977e2

Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/b8898331-f969-6d28-b5b1-65b26f579df9
lease_duration 	1h0m0s
lease_renewable	true
password       	f19160cf-46ee-d4a1-6aa6-8cf2934075cd
username       	token-d17c4873-dfd3-ea18-50f5-f6cfea2feaa5

Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/0c461eca-12bb-fffe-06cd-74e5632ac49c
lease_duration 	1h0m0s
lease_renewable	true
password       	66a77175-4c4e-bb7e-1e50-dbc20c5f81be
username       	token-f2bae7b4-4048-c2b1-65ac-4f7faf93249a

Key            	Value
---            	-----
lease_id       	postgresql/creds/readonly/1c6bc199-c331-2042-d335-ab0324ae998d
lease_duration 	1h0m0s
lease_renewable	true
password       	b0195932-42bb-d650-6703-c3e388902b4d
username       	token-8018cddc-4e0f-1718-a519-5e35d5a963ef

training@hashicorp > for i in {1..20}; do vault read postgresql/creds/readonly; done[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cpsql -U postgres[Kvault revoke postgresql/creds/readonly/f6f4d962-5935-6a3a-1ab4-f1c1a016eec2[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cpsql -U postgres[K
Welcome to PostgreSQL for HashiCorp training!
Type \q to exit.

postgres > \du
[?1049h[?1h=                                              List of roles
                 Role name                  |                   Attributes                   | Member of 
--------------------------------------------+------------------------------------------------+-----------
 postgres                                   | Superuser, Create role, Create DB, Replication | {}
 token-1366559c-b02f-a015-b53b-7954382e1e24 | Password valid until 2017-05-03 19:34:20+00    | {}
 token-26e96be9-779a-c531-5ae6-025223238d79 | Password valid until 2017-05-03 19:34:22+00    | {}
 token-2948673e-1c8d-78ca-95f4-6819b4da0b9c | Password valid until 2017-05-03 19:34:21+00    | {}
 token-2af0e521-9e62-db8b-17b3-d3b6f4ce887f | Password valid until 2017-05-03 19:34:19+00    | {}
 token-340348c1-0cae-c551-e4da-7a3b4fe2e8a9 | Password valid until 2017-05-03 19:34:19+00    | {}
 token-3df6feb8-e3d2-608d-b9a8-e77454ca11d0 | Password valid until 2017-05-03 19:34:21+00    | {}
 token-5916cb4e-2bd1-5e22-862f-343ed9d6b539 | Password valid until 2017-05-03 19:34:17+00    | {}
 token-5f7e3c1a-6a49-9623-70e5-41251a50ce02 | Password valid until 2017-05-03 19:34:16+00    | {}
 token-72879332-fcda-cea0-ec34-5c988167dd94 | Password valid until 2017-05-03 19:34:17+00    | {}
 token-7bc7e9b3-09f5-5b15-8dd1-928aa12c914a | Password valid until 2017-05-03 19:34:18+00    | {}
 token-8018cddc-4e0f-1718-a519-5e35d5a963ef | Password valid until 2017-05-03 19:34:25+00    | {}
 token-99098f29-07d3-35a3-037c-540e3b5e978f | Password valid until 2017-05-03 19:34:20+00    | {}
 token-a1b138be-51e7-5852-31e3-f00929ac021e | Password valid until 2017-05-03 19:34:19+00    | {}
 token-c4ee81e6-2f9a-4816-d9ff-0ec1476be79f | Password valid until 2017-05-03 19:34:15+00    | {}
 token-d0ca1790-6ca6-b45c-6d65-2b4822ee84c2 | Password valid until 2017-05-03 19:34:15+00    | {}
 token-d17c4873-dfd3-ea18-50f5-f6cfea2feaa5 | Password valid until 2017-05-03 19:34:24+00    | {}
 token-de5e11af-5f19-6e36-9be8-d79f884977e2 | Password valid until 2017-05-03 19:34:23+00    | {}
 token-e3f06c22-215f-a7ed-ed9d-272baaa776d4 | Password valid until 2017-05-03 19:34:18+00    | {}
 token-f2bae7b4-4048-c2b1-65ac-4f7faf93249a | Password valid until 2017-05-03 19:34:24+00    | {}
 token-f5f6f43d-7ea7-31a4-21a5-859bd5265d45 | Password valid until 2017-05-03 19:24:55+00    | {}
 token-ffc80404-02a0-55b8-5370-5d69cfc4f6fb | Password valid until 2017-05-03 19:34:22+00    | {}

[7m(END)[27m[K[K[K[7m(END)[27m[K[K[K[7m(END)[27m[K[K[K[7m(END)[27m[K[K[K[7m(END)[27m[K[K[K[7m(END)[27m[K[K [KESCESC[K^J^J[K[7m(END)[27m[K[K[K[7m(END)[27m[K[K[7m(END)[27m[K[K[7m(END)[27m[K[K[K[7m(END)[27m[K[K[K[7m(END)[27m[K[K[K[7m(END)[27m[K[K[K[7m(END)[27m[K[K[K[7m(END)[27m[K[K[K[7m(END)[27m[K[K[K[7m(END)[27m[K[K[K[7m(END)[27m[K[K[K[7m(END)[27m[K[K[K[7m(END)[27m[K[K[K[7m(END)[27m[K[K[K[7m(END)[27m[K[K[?1l>[?1049lpostgres > 
training@hashicorp > vault revoke -prefix postgresql/creds
Success! Revoked the secret with ID 'postgresql/creds', if it existed.
training@hashicorp > vault revoke -prefix postgresql/creds[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[21Ppsql -U postgres
Welcome